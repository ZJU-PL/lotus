

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GVFA (Global Value Flow Analysis) &mdash; Arlib Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=a74d790d"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Null Pointer Analysis" href="null_pointer.html" />
    <link rel="prev" title="Concurrency Analysis" href="concurrency.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Lotus
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/major_components.html">Major Components Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/architecture.html">Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/tutorials.html">Tutorials and Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/bug_detection.html">Bug Detection with Lotus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/pdg_query_language.html">PDG Query Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/troubleshooting.html">Troubleshooting and FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Command-Line Tools</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core Components</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../alias/index.html">Alias Analysis</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Analysis Framework</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#overview">Overview</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="cfg.html">CFG Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="concurrency.html">Concurrency Analysis</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">GVFA (Global Value Flow Analysis)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-line-tool-lotus-gvfa">Command-Line Tool: lotus-gvfa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#key-options">Key Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="null_pointer.html">Null Pointer Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="sprattus.html">Sprattus – Symbolic Abstraction Framework</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../annotation/index.html">Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apps/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cfl/index.html">Context-Free Language Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataflow/index.html">Data Flow Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ir/index.html">Intermediate Representations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solvers/index.html">Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transform/index.html">Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer/api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/developer_guide.html">Developer Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Lotus</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Analysis Framework</a></li>
      <li class="breadcrumb-item active">GVFA (Global Value Flow Analysis)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/analysis/gvfa.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gvfa-global-value-flow-analysis">
<h1>GVFA (Global Value Flow Analysis)<a class="headerlink" href="#gvfa-global-value-flow-analysis" title="Link to this heading"></a></h1>
<p>Global value flow analysis for tracking value propagation across functions.</p>
<p><strong>Headers</strong>: <code class="docutils literal notranslate"><span class="pre">include/Analysis/GVFA</span></code></p>
<p><strong>Implementation</strong>: <code class="docutils literal notranslate"><span class="pre">lib/Analysis/GVFA</span></code></p>
<p><strong>Main components</strong>:</p>
<ul class="simple">
<li><p><strong>GlobalValueFlowAnalysis</strong> – Interprocedural value-flow engine</p></li>
<li><p><strong>GVFAUtils</strong> – Utility helpers for building and querying GVFA</p></li>
<li><p><strong>ReachabilityAlgorithms</strong> – Algorithms for value reachability queries</p></li>
</ul>
<p><strong>Typical use cases</strong>:</p>
<ul class="simple">
<li><p>Trace how a value propagates across function boundaries</p></li>
<li><p>Answer “where can this value flow to?” queries</p></li>
<li><p>Build higher-level dataflow or taint analyses on top of value-flow results</p></li>
</ul>
<p><strong>Basic usage (C++)</strong>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Analysis/GVFA/GlobalValueFlowAnalysis.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Alias/DyckAA/DyckVFG.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Alias/DyckAA/DyckAliasAnalysis.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Alias/DyckAA/DyckModRefAnalysis.h&gt;</span>

<span class="n">llvm</span><span class="o">::</span><span class="n">Module</span><span class="w"> </span><span class="o">&amp;</span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span>
<span class="n">DyckVFG</span><span class="w"> </span><span class="o">*</span><span class="n">VFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cm">/* constructed elsewhere */</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="n">DyckAliasAnalysis</span><span class="w"> </span><span class="o">*</span><span class="n">AA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cm">/* constructed elsewhere */</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="n">DyckModRefAnalysis</span><span class="w"> </span><span class="o">*</span><span class="n">MRA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cm">/* constructed elsewhere */</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>

<span class="n">DyckGlobalValueFlowAnalysis</span><span class="w"> </span><span class="nf">gvfa</span><span class="p">(</span><span class="o">&amp;</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">VFG</span><span class="p">,</span><span class="w"> </span><span class="n">AA</span><span class="p">,</span><span class="w"> </span><span class="n">MRA</span><span class="p">);</span>
<span class="n">gvfa</span><span class="p">.</span><span class="n">run</span><span class="p">();</span>

<span class="k">const</span><span class="w"> </span><span class="n">llvm</span><span class="o">::</span><span class="n">Value</span><span class="w"> </span><span class="o">*</span><span class="n">Src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span>
<span class="k">const</span><span class="w"> </span><span class="n">llvm</span><span class="o">::</span><span class="n">Value</span><span class="w"> </span><span class="o">*</span><span class="n">Sink</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">flows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gvfa</span><span class="p">.</span><span class="n">cflReachable</span><span class="p">(</span><span class="n">Src</span><span class="p">,</span><span class="w"> </span><span class="n">Sink</span><span class="p">);</span>
<span class="c1">// Optionally, use GVFAUtils::getWitnessPath(...) to extract a witness path</span>
</pre></div>
</div>
</section>
<section id="command-line-tool-lotus-gvfa">
<h1>Command-Line Tool: lotus-gvfa<a class="headerlink" href="#command-line-tool-lotus-gvfa" title="Link to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">lotus-gvfa</span></code> tool provides global value flow analysis for vulnerability
detection, such as null pointer dereference analysis.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./build/bin/lotus-gvfa<span class="w"> </span><span class="o">[</span>options<span class="o">]</span><span class="w"> </span>&lt;input<span class="w"> </span>bitcode<span class="w"> </span>file&gt;
</pre></div>
</div>
<section id="key-options">
<h2>Key Options<a class="headerlink" href="#key-options" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-vuln-type=&lt;type&gt;</span></code> – Vulnerability type to detect - ‘nullpointer’
(default: ‘nullpointer’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-test-cfl-reachability</span></code> – Test CFL reachability queries for context-sensitive
analysis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-dump-stats</span></code> – Dump analysis statistics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-verbose</span></code> – Print detailed vulnerability information</p></li>
</ul>
<p>The tool uses Dyck alias analysis and value flow analysis to detect potential
vulnerabilities by tracking data flow from sources to sinks. It can detect
various memory bugs, such as NPD, UAF, etc.</p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Null pointer analysis</span>
./build/bin/lotus-gvfa<span class="w"> </span>input.bc

<span class="c1"># Context-sensitive analysis with statistics</span>
./build/bin/lotus-gvfa<span class="w"> </span>-test-cfl-reachability<span class="w"> </span>-dump-stats<span class="w"> </span>-verbose<span class="w"> </span>input.bc
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="concurrency.html" class="btn btn-neutral float-left" title="Concurrency Analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="null_pointer.html" class="btn btn-neutral float-right" title="Null Pointer Analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024-2025, ZJU Programming Languages and Automated Reasoning Group.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>