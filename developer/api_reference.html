

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; Arlib Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=a74d790d"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Developer Guide" href="developer_guide.html" />
    <link rel="prev" title="Utility Libraries" href="../utils/utilities.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Lotus
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/major_components.html">Major Components Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/architecture.html">Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/tutorials.html">Tutorials and Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/bug_detection.html">Bug Detection with Lotus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/pdg_query_language.html">PDG Query Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/troubleshooting.html">Troubleshooting and FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Command-Line Tools</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../alias/index.html">Alias Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis/index.html">Analysis Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../annotation/index.html">Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apps/index.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cfl/index.html">Context-Free Language Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataflow/index.html">Data Flow Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ir/index.html">Intermediate Representations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solvers/index.html">Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transform/index.html">Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#alias-analysis-apis">Alias Analysis APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dyckaa-api">DyckAA API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#aserpta-api">AserPTA API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lotusaa-api">LotusAA API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#intermediate-representation-apis">Intermediate Representation APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#program-dependence-graph-api">Program Dependence Graph API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pdg-query-language-api">PDG Query Language API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-flow-analysis-apis">Data Flow Analysis APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ifds-ide-framework-api">IFDS/IDE Framework API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#taint-analysis-api">Taint Analysis API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#abstract-interpretation-apis">Abstract Interpretation APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#clam-api">CLAM API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#constraint-solving-apis">Constraint Solving APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#smt-solver-api">SMT Solver API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bdd-solver-api">BDD Solver API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#bug-detection-apis">Bug Detection APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kint-api">Kint API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gvfa-api">GVFA API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#utility-apis">Utility APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#call-graph-api">Call Graph API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#memory-model-api">Memory Model API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-api">Configuration API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#example-complete-analysis-tool">Example: Complete Analysis Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="developer_guide.html">Developer Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Lotus</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/developer/api_reference.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading"></a></h1>
<p>This document provides API reference for programmatically using Lotus components.</p>
<section id="alias-analysis-apis">
<h2>Alias Analysis APIs<a class="headerlink" href="#alias-analysis-apis" title="Link to this heading"></a></h2>
<section id="dyckaa-api">
<h3>DyckAA API<a class="headerlink" href="#dyckaa-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Alias/DyckAA/DyckAliasAnalysis.h&quot;</span>
</pre></div>
</div>
<p>Basic usage as LLVM pass:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;llvm/IR/LLVMContext.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;llvm/IR/Module.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;llvm/IRReader/IRReader.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;llvm/Support/SourceMgr.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;llvm/IR/LegacyPassManager.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Alias/DyckAA/DyckAliasAnalysis.h&quot;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">llvm</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">LLVMContext</span><span class="w"> </span><span class="n">context</span><span class="p">;</span>
<span class="w">    </span><span class="n">SMDiagnostic</span><span class="w"> </span><span class="n">error</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Load module</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Module</span><span class="o">&gt;</span><span class="w"> </span><span class="k">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseIRFile</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">context</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">module</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">error</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">errs</span><span class="p">());</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Run DyckAA</span>
<span class="w">    </span><span class="n">legacy</span><span class="o">::</span><span class="n">PassManager</span><span class="w"> </span><span class="n">PM</span><span class="p">;</span>
<span class="w">    </span><span class="n">PM</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">DyckAliasAnalysis</span><span class="p">());</span>
<span class="w">    </span><span class="n">PM</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="o">*</span><span class="k">module</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Query alias information:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Get alias analysis result</span>
<span class="n">DyckAliasAnalysis</span><span class="w"> </span><span class="o">*</span><span class="n">DAA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DyckAliasAnalysis</span><span class="p">();</span>

<span class="c1">// Query if two values may alias</span>
<span class="n">AliasResult</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DAA</span><span class="o">-&gt;</span><span class="n">alias</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span><span class="w"> </span><span class="n">val2</span><span class="p">);</span>

<span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">NoAlias</span><span class="p">:</span>
<span class="w">        </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Definitely do not alias</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">MayAlias</span><span class="p">:</span>
<span class="w">        </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;May alias</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">MustAlias</span><span class="p">:</span>
<span class="w">        </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Must alias</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">PartialAlias</span><span class="p">:</span>
<span class="w">        </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Partially alias</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Access Dyck graph:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Alias/DyckAA/DyckGraph.h&quot;</span>

<span class="n">DyckGraph</span><span class="w"> </span><span class="o">*</span><span class="n">graph</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DAA</span><span class="o">-&gt;</span><span class="n">getDyckGraph</span><span class="p">();</span>

<span class="c1">// Get representative for a value</span>
<span class="n">DyckGraphNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">graph</span><span class="o">-&gt;</span><span class="n">retrieveDyckVertex</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="n">DyckGraphNode</span><span class="w"> </span><span class="o">*</span><span class="n">rep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">getRep</span><span class="p">();</span>

<span class="c1">// Iterate over alias set</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">*</span><span class="n">aliasNode</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">rep</span><span class="o">-&gt;</span><span class="n">getAliasSet</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Value</span><span class="w"> </span><span class="o">*</span><span class="n">aliasValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aliasNode</span><span class="o">-&gt;</span><span class="n">getValue</span><span class="p">();</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Alias: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">*</span><span class="n">aliasValue</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="aserpta-api">
<h3>AserPTA API<a class="headerlink" href="#aserpta-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Alias/AserPTA/PointerAnalysis/PointerAnalysis.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Alias/AserPTA/PointerAnalysis/Context/Context.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Alias/AserPTA/PointerAnalysis/Solver/Solver.h&quot;</span>
</pre></div>
</div>
<p>Configure and run analysis:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Alias/AserPTA/PointerAnalysis/Program/Program.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Alias/AserPTA/PointerAnalysis/PointerAnalysis.h&quot;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">aser</span><span class="p">;</span>

<span class="c1">// Build program representation</span>
<span class="n">Program</span><span class="w"> </span><span class="nf">program</span><span class="p">(</span><span class="k">module</span><span class="p">);</span>
<span class="n">program</span><span class="p">.</span><span class="n">build</span><span class="p">();</span>

<span class="c1">// Create analysis with context sensitivity</span>
<span class="n">PointerAnalysis</span><span class="o">&lt;</span><span class="n">Context</span><span class="o">::</span><span class="n">KCallSite</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">MemModel</span><span class="o">::</span><span class="n">FieldSensitive</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pta</span><span class="p">(</span><span class="n">program</span><span class="p">);</span>

<span class="c1">// Run solver</span>
<span class="n">pta</span><span class="p">.</span><span class="n">solve</span><span class="p">();</span>

<span class="c1">// Query points-to sets</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">*</span><span class="n">val</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">program</span><span class="p">.</span><span class="n">getPointers</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">PointsToSet</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pta</span><span class="p">.</span><span class="n">getPointsToSet</span><span class="p">(</span><span class="n">val</span><span class="p">);</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Pointer: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">*</span><span class="n">val</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; points to:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">objID</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">pts</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  Object &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">objID</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Custom context sensitivity:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Context-insensitive</span>
<span class="n">PointerAnalysis</span><span class="o">&lt;</span><span class="n">Context</span><span class="o">::</span><span class="n">NoCtx</span><span class="p">,</span><span class="w"> </span><span class="n">MemModel</span><span class="o">::</span><span class="n">FieldInsensitive</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pta_ci</span><span class="p">(</span><span class="n">program</span><span class="p">);</span>

<span class="c1">// 1-CFA (1-call-site sensitive)</span>
<span class="n">PointerAnalysis</span><span class="o">&lt;</span><span class="n">Context</span><span class="o">::</span><span class="n">KCallSite</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">MemModel</span><span class="o">::</span><span class="n">FieldSensitive</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pta_1cfa</span><span class="p">(</span><span class="n">program</span><span class="p">);</span>

<span class="c1">// 2-CFA</span>
<span class="n">PointerAnalysis</span><span class="o">&lt;</span><span class="n">Context</span><span class="o">::</span><span class="n">KCallSite</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">MemModel</span><span class="o">::</span><span class="n">FieldSensitive</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pta_2cfa</span><span class="p">(</span><span class="n">program</span><span class="p">);</span>

<span class="c1">// Origin-sensitive</span>
<span class="n">PointerAnalysis</span><span class="o">&lt;</span><span class="n">Context</span><span class="o">::</span><span class="n">KOrigin</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">MemModel</span><span class="o">::</span><span class="n">FieldSensitive</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pta_origin</span><span class="p">(</span><span class="n">program</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="lotusaa-api">
<h3>LotusAA API<a class="headerlink" href="#lotusaa-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Alias/LotusAA/Engine/InterProceduralPass.h&quot;</span>
</pre></div>
</div>
<p>Use as LLVM pass:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">legacy</span><span class="o">::</span><span class="n">PassManager</span><span class="w"> </span><span class="n">PM</span><span class="p">;</span>
<span class="n">PM</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">LotusAA</span><span class="p">());</span>
<span class="n">PM</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="o">*</span><span class="k">module</span><span class="p">);</span>
</pre></div>
</div>
<p>Query results:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">LotusAA</span><span class="w"> </span><span class="o">*</span><span class="n">lotus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LotusAA</span><span class="p">();</span>
<span class="c1">// ... run analysis ...</span>

<span class="c1">// Get points-to graph</span>
<span class="n">PointsToGraph</span><span class="w"> </span><span class="o">*</span><span class="n">ptg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lotus</span><span class="o">-&gt;</span><span class="n">getPointsToGraph</span><span class="p">();</span>

<span class="c1">// Query points-to set for a value</span>
<span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span><span class="n">MemObject</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">pts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ptg</span><span class="o">-&gt;</span><span class="n">getPointsToSet</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">*</span><span class="n">obj</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">pts</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Points to: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">obj</span><span class="o">-&gt;</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="intermediate-representation-apis">
<h2>Intermediate Representation APIs<a class="headerlink" href="#intermediate-representation-apis" title="Link to this heading"></a></h2>
<section id="program-dependence-graph-api">
<h3>Program Dependence Graph API<a class="headerlink" href="#program-dependence-graph-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IR/PDG/ProgramDependencyGraph.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IR/PDG/Graph.h&quot;</span>
</pre></div>
</div>
<p>Build PDG:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">pdg</span><span class="p">;</span>

<span class="c1">// Register required passes</span>
<span class="n">legacy</span><span class="o">::</span><span class="n">PassManager</span><span class="w"> </span><span class="n">PM</span><span class="p">;</span>
<span class="n">PM</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">DataDependencyGraph</span><span class="p">());</span>
<span class="n">PM</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ControlDependencyGraph</span><span class="p">());</span>
<span class="n">PM</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ProgramDependencyGraph</span><span class="p">());</span>
<span class="n">PM</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="o">*</span><span class="k">module</span><span class="p">);</span>

<span class="c1">// Get PDG instance</span>
<span class="n">ProgramGraph</span><span class="w"> </span><span class="o">*</span><span class="n">pdg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ProgramGraph</span><span class="o">::</span><span class="n">getInstance</span><span class="p">();</span>
</pre></div>
</div>
<p>Traverse PDG:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Iterate over all nodes</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">pdg</span><span class="o">-&gt;</span><span class="n">getNodes</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Node type: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">getNodeTypeStr</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Get outgoing edges</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">*</span><span class="n">edge</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">getOutEdges</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">edge</span><span class="o">-&gt;</span><span class="n">getTarget</span><span class="p">();</span>
<span class="w">        </span><span class="n">EdgeType</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">edge</span><span class="o">-&gt;</span><span class="n">getEdgeType</span><span class="p">();</span>
<span class="w">        </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  -&gt; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">target</span><span class="o">-&gt;</span><span class="n">getNodeTypeStr</span><span class="p">()</span>
<span class="w">               </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; (edge: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">edge</span><span class="o">-&gt;</span><span class="n">getEdgeTypeStr</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Query node types:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Get function wrapper</span>
<span class="n">Function</span><span class="w"> </span><span class="o">*</span><span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cm">/* ... */</span><span class="p">;</span>
<span class="n">FunctionWrapper</span><span class="w"> </span><span class="o">*</span><span class="n">fw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdg</span><span class="o">-&gt;</span><span class="n">getFuncWrapperMap</span><span class="p">()[</span><span class="n">F</span><span class="p">];</span>

<span class="c1">// Get entry node</span>
<span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="n">entryNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fw</span><span class="o">-&gt;</span><span class="n">getEntryNode</span><span class="p">();</span>

<span class="c1">// Get formal input parameters</span>
<span class="n">Tree</span><span class="w"> </span><span class="o">*</span><span class="n">formalInTree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fw</span><span class="o">-&gt;</span><span class="n">getFormalInTree</span><span class="p">();</span>

<span class="c1">// Get formal output (return values)</span>
<span class="n">Tree</span><span class="w"> </span><span class="o">*</span><span class="n">formalOutTree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fw</span><span class="o">-&gt;</span><span class="n">getFormalOutTree</span><span class="p">();</span>
</pre></div>
</div>
<p>Check dependencies:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Check if there&#39;s a path from src to dst</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">hasPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdg</span><span class="o">-&gt;</span><span class="n">canReach</span><span class="p">(</span><span class="o">*</span><span class="n">srcNode</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">dstNode</span><span class="p">);</span>

<span class="c1">// Check reachability excluding certain edge types</span>
<span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span><span class="n">EdgeType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">exclude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">EdgeType</span><span class="o">::</span><span class="n">CONTROL_DEP</span><span class="p">};</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">hasDataPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdg</span><span class="o">-&gt;</span><span class="n">canReach</span><span class="p">(</span><span class="o">*</span><span class="n">srcNode</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">dstNode</span><span class="p">,</span><span class="w"> </span><span class="n">exclude</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="pdg-query-language-api">
<h3>PDG Query Language API<a class="headerlink" href="#pdg-query-language-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IR/PDG/QueryLanguage.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IR/PDG/QueryParser.h&quot;</span>
</pre></div>
</div>
<p>Parse and execute queries:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">pdg</span><span class="p">;</span>

<span class="c1">// Build PDG first</span>
<span class="n">ProgramDependencyGraph</span><span class="w"> </span><span class="o">*</span><span class="n">pdgPass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cm">/* get pass */</span><span class="p">;</span>
<span class="n">ProgramGraph</span><span class="w"> </span><span class="o">*</span><span class="n">pdg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdgPass</span><span class="o">-&gt;</span><span class="n">getPDG</span><span class="p">();</span>

<span class="c1">// Create query context</span>
<span class="n">QueryContext</span><span class="w"> </span><span class="nf">ctx</span><span class="p">(</span><span class="n">pdg</span><span class="p">);</span>

<span class="c1">// Parse query</span>
<span class="n">QueryParser</span><span class="w"> </span><span class="n">parser</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;returnsOf(</span><span class="se">\&quot;</span><span class="s">main</span><span class="se">\&quot;</span><span class="s">)&quot;</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">QueryExpr</span><span class="o">&gt;</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parser</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>

<span class="c1">// Execute query</span>
<span class="n">NodeSet</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expr</span><span class="o">-&gt;</span><span class="n">evaluate</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>

<span class="c1">// Process results</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Result node: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Define custom query expressions:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Forward slice</span>
<span class="n">ForwardSliceExpr</span><span class="w"> </span><span class="nf">fwdSlice</span><span class="p">(</span><span class="n">sourceExpr</span><span class="p">);</span>
<span class="n">NodeSet</span><span class="w"> </span><span class="n">slice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fwdSlice</span><span class="p">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>

<span class="c1">// Backward slice</span>
<span class="n">BackwardSliceExpr</span><span class="w"> </span><span class="nf">bwdSlice</span><span class="p">(</span><span class="n">sinkExpr</span><span class="p">);</span>
<span class="n">NodeSet</span><span class="w"> </span><span class="n">bwdSlice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bwdSlice</span><span class="p">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>

<span class="c1">// Set operations</span>
<span class="n">UnionExpr</span><span class="w"> </span><span class="nf">unionExpr</span><span class="p">(</span><span class="n">expr1</span><span class="p">,</span><span class="w"> </span><span class="n">expr2</span><span class="p">);</span>
<span class="n">IntersectExpr</span><span class="w"> </span><span class="nf">intersectExpr</span><span class="p">(</span><span class="n">expr1</span><span class="p">,</span><span class="w"> </span><span class="n">expr2</span><span class="p">);</span>
<span class="n">DiffExpr</span><span class="w"> </span><span class="nf">diffExpr</span><span class="p">(</span><span class="n">expr1</span><span class="p">,</span><span class="w"> </span><span class="n">expr2</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="data-flow-analysis-apis">
<h2>Data Flow Analysis APIs<a class="headerlink" href="#data-flow-analysis-apis" title="Link to this heading"></a></h2>
<section id="ifds-ide-framework-api">
<h3>IFDS/IDE Framework API<a class="headerlink" href="#ifds-ide-framework-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Dataflow/IFDS/IFDSSolver.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Dataflow/IFDS/FlowFunction.h&quot;</span>
</pre></div>
</div>
<p>Define flow functions:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Dataflow/IFDS/IFDSProblem.h&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyTaintAnalysis</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">IFDSProblem</span><span class="o">&lt;</span><span class="n">Value</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Function</span><span class="o">*&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// Define initial seeds</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span><span class="n">Value</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">initialSeeds</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span><span class="n">Value</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">seeds</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// Add taint sources</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">F</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">module</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;getInput&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// Return value is tainted</span>
<span class="w">                </span><span class="n">seeds</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="o">&amp;</span><span class="n">F</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">seeds</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Normal flow function</span>
<span class="w">    </span><span class="n">FlowFunctionPtr</span><span class="w"> </span><span class="n">getNormalFlowFunction</span><span class="p">(</span><span class="n">Instruction</span><span class="w"> </span><span class="o">*</span><span class="n">curr</span><span class="p">,</span>
<span class="w">                                          </span><span class="n">Instruction</span><span class="w"> </span><span class="o">*</span><span class="n">succ</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Define how facts flow through instructions</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">*</span><span class="n">call</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dyn_cast</span><span class="o">&lt;</span><span class="n">CallInst</span><span class="o">&gt;</span><span class="p">(</span><span class="n">curr</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isSanitizer</span><span class="p">(</span><span class="n">call</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// Kill taint at sanitizer</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">KillAllFlowFunction</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">// Identity by default</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">IdentityFlowFunction</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Call flow function</span>
<span class="w">    </span><span class="n">FlowFunctionPtr</span><span class="w"> </span><span class="n">getCallFlowFunction</span><span class="p">(</span><span class="n">Instruction</span><span class="w"> </span><span class="o">*</span><span class="n">callSite</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">Function</span><span class="w"> </span><span class="o">*</span><span class="n">destFun</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Map actual parameters to formal parameters</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">ParameterMapFlowFunction</span><span class="o">&gt;</span><span class="p">(</span><span class="n">callSite</span><span class="p">,</span><span class="w"> </span><span class="n">destFun</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Return flow function</span>
<span class="w">    </span><span class="n">FlowFunctionPtr</span><span class="w"> </span><span class="n">getReturnFlowFunction</span><span class="p">(</span><span class="n">Instruction</span><span class="w"> </span><span class="o">*</span><span class="n">callSite</span><span class="p">,</span>
<span class="w">                                          </span><span class="n">Function</span><span class="w"> </span><span class="o">*</span><span class="n">calleeFun</span><span class="p">,</span>
<span class="w">                                          </span><span class="n">Instruction</span><span class="w"> </span><span class="o">*</span><span class="n">exitInst</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Map return value to call site</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">ReturnMapFlowFunction</span><span class="o">&gt;</span><span class="p">(</span><span class="n">callSite</span><span class="p">,</span><span class="w"> </span><span class="n">exitInst</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Run IFDS solver:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">MyTaintAnalysis</span><span class="w"> </span><span class="nf">problem</span><span class="p">(</span><span class="k">module</span><span class="p">);</span>
<span class="n">IFDSSolver</span><span class="o">&lt;</span><span class="n">Value</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Function</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">solver</span><span class="p">(</span><span class="n">problem</span><span class="p">);</span>
<span class="n">solver</span><span class="p">.</span><span class="n">solve</span><span class="p">();</span>

<span class="c1">// Query results</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">F</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">module</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">BB</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">F</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">I</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">BB</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">facts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">solver</span><span class="p">.</span><span class="n">ifdsResultsAt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">I</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">facts</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Tainted at: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">*</span><span class="n">fact</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">facts</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  Fact: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">*</span><span class="n">fact</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="taint-analysis-api">
<h3>Taint Analysis API<a class="headerlink" href="#taint-analysis-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Dataflow/TaintAnalysis/TaintAnalysis.h&quot;</span>
</pre></div>
</div>
<p>Configure and run:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create taint analysis</span>
<span class="n">TaintAnalysis</span><span class="w"> </span><span class="nf">taint</span><span class="p">(</span><span class="k">module</span><span class="p">);</span>

<span class="c1">// Configure sources</span>
<span class="n">taint</span><span class="p">.</span><span class="n">addSourceFunction</span><span class="p">(</span><span class="s">&quot;scanf&quot;</span><span class="p">);</span>
<span class="n">taint</span><span class="p">.</span><span class="n">addSourceFunction</span><span class="p">(</span><span class="s">&quot;gets&quot;</span><span class="p">);</span>
<span class="n">taint</span><span class="p">.</span><span class="n">addSourceFunction</span><span class="p">(</span><span class="s">&quot;read&quot;</span><span class="p">);</span>

<span class="c1">// Configure sinks</span>
<span class="n">taint</span><span class="p">.</span><span class="n">addSinkFunction</span><span class="p">(</span><span class="s">&quot;system&quot;</span><span class="p">);</span>
<span class="n">taint</span><span class="p">.</span><span class="n">addSinkFunction</span><span class="p">(</span><span class="s">&quot;exec&quot;</span><span class="p">);</span>
<span class="n">taint</span><span class="p">.</span><span class="n">addSinkFunction</span><span class="p">(</span><span class="s">&quot;popen&quot;</span><span class="p">);</span>

<span class="c1">// Run analysis</span>
<span class="n">taint</span><span class="p">.</span><span class="n">analyze</span><span class="p">();</span>

<span class="c1">// Get results</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">TaintFlow</span><span class="o">&gt;</span><span class="w"> </span><span class="n">flows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taint</span><span class="p">.</span><span class="n">getTaintFlows</span><span class="p">();</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">flow</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">flows</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Taint flow:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  Source: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">*</span><span class="n">flow</span><span class="p">.</span><span class="n">source</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  Sink: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">*</span><span class="n">flow</span><span class="p">.</span><span class="n">sink</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  Path length: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">flow</span><span class="p">.</span><span class="n">pathLength</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="abstract-interpretation-apis">
<h2>Abstract Interpretation APIs<a class="headerlink" href="#abstract-interpretation-apis" title="Link to this heading"></a></h2>
<section id="clam-api">
<h3>CLAM API<a class="headerlink" href="#clam-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Apps/clam/Clam.hh&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Apps/clam/ClamAnalysisParams.hh&quot;</span>
</pre></div>
</div>
<p>Configure analysis:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">clam</span><span class="p">;</span>

<span class="c1">// Set analysis parameters</span>
<span class="n">ClamAnalysisParams</span><span class="w"> </span><span class="n">params</span><span class="p">;</span>
<span class="n">params</span><span class="p">.</span><span class="n">dom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;zones&quot;</span><span class="p">;</span><span class="w">  </span><span class="c1">// Abstract domain</span>
<span class="n">params</span><span class="p">.</span><span class="n">run_inter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">  </span><span class="c1">// Interprocedural</span>
<span class="n">params</span><span class="p">.</span><span class="n">check_nulls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">  </span><span class="c1">// Check null pointers</span>
<span class="n">params</span><span class="p">.</span><span class="n">check_bounds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">  </span><span class="c1">// Check array bounds</span>

<span class="c1">// Create analyzer</span>
<span class="n">ClamGlobalAnalysis</span><span class="w"> </span><span class="nf">analyzer</span><span class="p">(</span><span class="k">module</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">);</span>

<span class="c1">// Run analysis</span>
<span class="n">analyzer</span><span class="p">.</span><span class="n">analyze</span><span class="p">();</span>
</pre></div>
</div>
<p>Query invariants:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Get invariants at a program point</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">F</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">module</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">BB</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">F</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">clam_abstract_domain</span><span class="w"> </span><span class="n">inv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">analyzer</span><span class="p">.</span><span class="n">get_pre</span><span class="p">(</span><span class="o">&amp;</span><span class="n">BB</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Check if a variable is in range</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">inv</span><span class="p">.</span><span class="n">is_bottom</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Unreachable basic block</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Invariant at &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">BB</span><span class="p">.</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;: &quot;</span><span class="p">;</span>
<span class="w">            </span><span class="n">inv</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">errs</span><span class="p">());</span>
<span class="w">            </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Check properties:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;crab/checkers/base_property.hpp&quot;</span>

<span class="c1">// Get check results</span>
<span class="k">auto</span><span class="w"> </span><span class="n">checks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">analyzer</span><span class="p">.</span><span class="n">get_all_checks</span><span class="p">();</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">check</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">checks</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">check</span><span class="p">.</span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">crab</span><span class="o">::</span><span class="no">checker</span><span class="o">::</span><span class="no">check_kind</span><span class="o">::</span><span class="no">SAFE</span><span class="p">:</span>
<span class="w">            </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;SAFE: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">check</span><span class="p">.</span><span class="n">description</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">crab</span><span class="o">::</span><span class="no">checker</span><span class="o">::</span><span class="no">check_kind</span><span class="o">::</span><span class="no">WARNING</span><span class="p">:</span>
<span class="w">            </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;WARNING: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">check</span><span class="p">.</span><span class="n">description</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">crab</span><span class="o">::</span><span class="no">checker</span><span class="o">::</span><span class="no">check_kind</span><span class="o">::</span><span class="no">ERROR</span><span class="p">:</span>
<span class="w">            </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ERROR: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">check</span><span class="p">.</span><span class="n">description</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="constraint-solving-apis">
<h2>Constraint Solving APIs<a class="headerlink" href="#constraint-solving-apis" title="Link to this heading"></a></h2>
<section id="smt-solver-api">
<h3>SMT Solver API<a class="headerlink" href="#smt-solver-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Solvers/SMT/Z3Solver.h&quot;</span>
</pre></div>
</div>
<p>Basic usage:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">lotus</span><span class="o">::</span><span class="nn">smt</span><span class="p">;</span>

<span class="c1">// Create Z3 context and solver</span>
<span class="n">Z3Solver</span><span class="w"> </span><span class="n">solver</span><span class="p">;</span>

<span class="c1">// Create variables</span>
<span class="n">z3</span><span class="o">::</span><span class="n">expr</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">solver</span><span class="p">.</span><span class="n">makeIntVar</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">);</span>
<span class="n">z3</span><span class="o">::</span><span class="n">expr</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">solver</span><span class="p">.</span><span class="n">makeIntVar</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">);</span>

<span class="c1">// Add constraints</span>
<span class="n">solver</span><span class="p">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="n">solver</span><span class="p">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="n">solver</span><span class="p">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>

<span class="c1">// Check satisfiability</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">solver</span><span class="p">.</span><span class="n">check</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">z3</span><span class="o">::</span><span class="n">sat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">z3</span><span class="o">::</span><span class="n">model</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">solver</span><span class="p">.</span><span class="n">getModel</span><span class="p">();</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">x_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">eval</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">get_numeral_int</span><span class="p">();</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">y_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="p">.</span><span class="n">eval</span><span class="p">(</span><span class="n">y</span><span class="p">).</span><span class="n">get_numeral_int</span><span class="p">();</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Solution: x = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x_val</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, y = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">y_val</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Unsatisfiable</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Build complex formulas:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Logical operations</span>
<span class="n">z3</span><span class="o">::</span><span class="n">expr</span><span class="w"> </span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>

<span class="c1">// Arrays</span>
<span class="n">z3</span><span class="o">::</span><span class="n">expr</span><span class="w"> </span><span class="n">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">solver</span><span class="p">.</span><span class="n">makeArrayVar</span><span class="p">(</span><span class="s">&quot;arr&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">solver</span><span class="p">.</span><span class="n">intSort</span><span class="p">());</span>
<span class="n">z3</span><span class="o">::</span><span class="n">expr</span><span class="w"> </span><span class="n">arrSelect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z3</span><span class="o">::</span><span class="n">select</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="n">solver</span><span class="p">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="n">arrSelect</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">42</span><span class="p">);</span>

<span class="c1">// Quantifiers</span>
<span class="n">z3</span><span class="o">::</span><span class="n">expr</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">solver</span><span class="p">.</span><span class="n">makeIntVar</span><span class="p">(</span><span class="s">&quot;i&quot;</span><span class="p">);</span>
<span class="n">z3</span><span class="o">::</span><span class="n">expr</span><span class="w"> </span><span class="n">forall</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z3</span><span class="o">::</span><span class="n">forall</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">z3</span><span class="o">::</span><span class="n">implies</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">                                             </span><span class="n">z3</span><span class="o">::</span><span class="n">select</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span>
</pre></div>
</div>
</section>
<section id="bdd-solver-api">
<h3>BDD Solver API<a class="headerlink" href="#bdd-solver-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Solvers/BDD/BDDSolver.h&quot;</span>
</pre></div>
</div>
<p>Basic operations:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">lotus</span><span class="o">::</span><span class="nn">bdd</span><span class="p">;</span>

<span class="c1">// Initialize BDD manager</span>
<span class="n">BDDManager</span><span class="w"> </span><span class="n">mgr</span><span class="p">;</span>

<span class="c1">// Create variables</span>
<span class="n">BDD</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mgr</span><span class="p">.</span><span class="n">createVar</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">);</span>
<span class="n">BDD</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mgr</span><span class="p">.</span><span class="n">createVar</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">);</span>
<span class="n">BDD</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mgr</span><span class="p">.</span><span class="n">createVar</span><span class="p">(</span><span class="s">&quot;z&quot;</span><span class="p">);</span>

<span class="c1">// Boolean operations</span>
<span class="n">BDD</span><span class="w"> </span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="o">~</span><span class="n">z</span><span class="p">);</span>

<span class="c1">// Check satisfiability</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">formula</span><span class="p">.</span><span class="n">isZero</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Formula is satisfiable</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Get one satisfying assignment</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">assignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">formula</span><span class="p">.</span><span class="n">oneSat</span><span class="p">();</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="p">[</span><span class="n">var</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">assignment</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="bug-detection-apis">
<h2>Bug Detection APIs<a class="headerlink" href="#bug-detection-apis" title="Link to this heading"></a></h2>
<section id="kint-api">
<h3>Kint API<a class="headerlink" href="#kint-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Checker/KINT/MKintPass.h&quot;</span>
</pre></div>
</div>
<p>Use programmatically:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create pass</span>
<span class="n">MKintPass</span><span class="w"> </span><span class="n">kintPass</span><span class="p">;</span>

<span class="c1">// Configure checkers</span>
<span class="n">kintPass</span><span class="p">.</span><span class="n">enableChecker</span><span class="p">(</span><span class="n">CheckerType</span><span class="o">::</span><span class="n">IntOverflow</span><span class="p">);</span>
<span class="n">kintPass</span><span class="p">.</span><span class="n">enableChecker</span><span class="p">(</span><span class="n">CheckerType</span><span class="o">::</span><span class="n">ArrayOutOfBounds</span><span class="p">);</span>

<span class="c1">// Run on module</span>
<span class="n">kintPass</span><span class="p">.</span><span class="n">runOnModule</span><span class="p">(</span><span class="k">module</span><span class="p">);</span>

<span class="c1">// Get bug reports</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">BugReport</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bugs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kintPass</span><span class="p">.</span><span class="n">getBugReports</span><span class="p">();</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bug</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">bugs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Bug Type: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">bug</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Location: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">bug</span><span class="p">.</span><span class="n">location</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Description: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">bug</span><span class="p">.</span><span class="n">description</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="gvfa-api">
<h3>GVFA API<a class="headerlink" href="#gvfa-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Analysis/GVFA/GlobalValueFlowAnalysis.h&quot;</span>
</pre></div>
</div>
<p>Detect null pointer bugs:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create GVFA</span>
<span class="n">GlobalValueFlowAnalysis</span><span class="w"> </span><span class="nf">gvfa</span><span class="p">(</span><span class="k">module</span><span class="p">);</span>

<span class="c1">// Run null pointer analysis</span>
<span class="n">gvfa</span><span class="p">.</span><span class="n">detectNullPointerBugs</span><span class="p">();</span>

<span class="c1">// Get vulnerable dereferences</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">NullDerefBug</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bugs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gvfa</span><span class="p">.</span><span class="n">getNullPointerBugs</span><span class="p">();</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bug</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">bugs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Potential null dereference:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  Instruction: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">*</span><span class="n">bug</span><span class="p">.</span><span class="n">instruction</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  Pointer: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">*</span><span class="n">bug</span><span class="p">.</span><span class="n">pointer</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  Null source: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">*</span><span class="n">bug</span><span class="p">.</span><span class="n">nullSource</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="utility-apis">
<h2>Utility APIs<a class="headerlink" href="#utility-apis" title="Link to this heading"></a></h2>
<section id="call-graph-api">
<h3>Call Graph API<a class="headerlink" href="#call-graph-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IR/PDG/PDGCallGraph.h&quot;</span>
</pre></div>
</div>
<p>Build and query call graph:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">pdg</span><span class="p">;</span>

<span class="n">PDGCallGraph</span><span class="w"> </span><span class="o">&amp;</span><span class="n">cg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PDGCallGraph</span><span class="o">::</span><span class="n">getInstance</span><span class="p">();</span>
<span class="n">cg</span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="k">module</span><span class="p">);</span>

<span class="c1">// Get callers of a function</span>
<span class="n">Function</span><span class="w"> </span><span class="o">*</span><span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cm">/* ... */</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span><span class="n">CallInst</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">callers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cg</span><span class="p">.</span><span class="n">getCallers</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>

<span class="c1">// Get callees of a call site</span>
<span class="n">CallInst</span><span class="w"> </span><span class="o">*</span><span class="n">call</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cm">/* ... */</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span><span class="n">Function</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">callees</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cg</span><span class="p">.</span><span class="n">getCallees</span><span class="p">(</span><span class="n">call</span><span class="p">);</span>

<span class="c1">// Check if function is reachable</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">reachable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cg</span><span class="p">.</span><span class="n">isReachable</span><span class="p">(</span><span class="n">mainFunc</span><span class="p">,</span><span class="w"> </span><span class="n">targetFunc</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="memory-model-api">
<h3>Memory Model API<a class="headerlink" href="#memory-model-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Alias/AserPTA/PointerAnalysis/Model/MemModels.h&quot;</span>
</pre></div>
</div>
<p>Query memory objects:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Get object ID for a value</span>
<span class="n">ObjID</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">memModel</span><span class="p">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>

<span class="c1">// Get field offset</span>
<span class="n">FieldOffset</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">memModel</span><span class="p">.</span><span class="n">getFieldOffset</span><span class="p">(</span><span class="n">gepInst</span><span class="p">);</span>

<span class="c1">// Check if field-sensitive</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">memModel</span><span class="p">.</span><span class="n">isFieldSensitive</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Using field-sensitive model</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="configuration-api">
<h3>Configuration API<a class="headerlink" href="#configuration-api" title="Link to this heading"></a></h3>
<p>Include headers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Utils/Config/LotusConfig.h&quot;</span>
</pre></div>
</div>
<p>Load and use configuration:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Load YAML configuration</span>
<span class="n">LotusConfig</span><span class="w"> </span><span class="n">config</span><span class="p">;</span>
<span class="n">config</span><span class="p">.</span><span class="n">loadFromFile</span><span class="p">(</span><span class="s">&quot;config.yaml&quot;</span><span class="p">);</span>

<span class="c1">// Query configuration values</span>
<span class="kt">int</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">getInt</span><span class="p">(</span><span class="s">&quot;analysis.timeout&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">);</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">getBool</span><span class="p">(</span><span class="s">&quot;logging.verbose&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="s">&quot;clam.domain&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;zones&quot;</span><span class="p">);</span>

<span class="c1">// Set configuration programmatically</span>
<span class="n">config</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;analysis.max_iterations&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">);</span>
<span class="n">config</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;checker.enabled&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="example-complete-analysis-tool">
<h2>Example: Complete Analysis Tool<a class="headerlink" href="#example-complete-analysis-tool" title="Link to this heading"></a></h2>
<p>Here’s a complete example of building a custom analysis tool:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;llvm/IR/LLVMContext.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;llvm/IR/Module.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;llvm/IRReader/IRReader.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;llvm/Support/SourceMgr.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;llvm/IR/LegacyPassManager.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Alias/DyckAA/DyckAliasAnalysis.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;IR/PDG/ProgramDependencyGraph.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Dataflow/TaintAnalysis/TaintAnalysis.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Checker/KINT/MKintPass.h&quot;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">llvm</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Usage: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &lt;input.bc&gt;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Load module</span>
<span class="w">    </span><span class="n">LLVMContext</span><span class="w"> </span><span class="n">context</span><span class="p">;</span>
<span class="w">    </span><span class="n">SMDiagnostic</span><span class="w"> </span><span class="n">error</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Module</span><span class="o">&gt;</span><span class="w"> </span><span class="k">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseIRFile</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">context</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">module</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">error</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">errs</span><span class="p">());</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Run analyses</span>
<span class="w">    </span><span class="n">legacy</span><span class="o">::</span><span class="n">PassManager</span><span class="w"> </span><span class="n">PM</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 1. Alias analysis</span>
<span class="w">    </span><span class="n">PM</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">DyckAliasAnalysis</span><span class="p">());</span>

<span class="w">    </span><span class="c1">// 2. Build PDG</span>
<span class="w">    </span><span class="n">PM</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">pdg</span><span class="o">::</span><span class="n">DataDependencyGraph</span><span class="p">());</span>
<span class="w">    </span><span class="n">PM</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">pdg</span><span class="o">::</span><span class="n">ControlDependencyGraph</span><span class="p">());</span>
<span class="w">    </span><span class="n">PM</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">pdg</span><span class="o">::</span><span class="n">ProgramDependencyGraph</span><span class="p">());</span>

<span class="w">    </span><span class="c1">// 3. Bug detection</span>
<span class="w">    </span><span class="n">PM</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">MKintPass</span><span class="p">());</span>

<span class="w">    </span><span class="n">PM</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="o">*</span><span class="k">module</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 4. Taint analysis</span>
<span class="w">    </span><span class="n">TaintAnalysis</span><span class="w"> </span><span class="n">taint</span><span class="p">(</span><span class="o">*</span><span class="k">module</span><span class="p">);</span>
<span class="w">    </span><span class="n">taint</span><span class="p">.</span><span class="n">addSourceFunction</span><span class="p">(</span><span class="s">&quot;scanf&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">taint</span><span class="p">.</span><span class="n">addSinkFunction</span><span class="p">(</span><span class="s">&quot;system&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">taint</span><span class="p">.</span><span class="n">analyze</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Print results</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">flows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taint</span><span class="p">.</span><span class="n">getTaintFlows</span><span class="p">();</span>
<span class="w">    </span><span class="n">errs</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Found &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">flows</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; taint flows</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Compile and link:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>clang++<span class="w"> </span>-o<span class="w"> </span>my_analyzer<span class="w"> </span>my_analyzer.cpp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="k">$(</span>llvm-config<span class="w"> </span>--cxxflags<span class="w"> </span>--ldflags<span class="w"> </span>--libs<span class="k">)</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-L/path/to/lotus/build/lib<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-lLotusAlias<span class="w"> </span>-lLotusIR<span class="w"> </span>-lLotusDataflow<span class="w"> </span>-lLotusChecker
</pre></div>
</div>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../user_guide/architecture.html"><span class="doc">Architecture Overview</span></a> - Understanding the framework architecture</p></li>
<li><p><a class="reference internal" href="../user_guide/tutorials.html"><span class="doc">Tutorials and Examples</span></a> - Practical usage examples</p></li>
<li><p><a class="reference internal" href="developer_guide.html"><span class="doc">Developer Guide</span></a> - Extending Lotus</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../utils/utilities.html" class="btn btn-neutral float-left" title="Utility Libraries" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="developer_guide.html" class="btn btn-neutral float-right" title="Developer Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024-2025, ZJU Programming Languages and Automated Reasoning Group.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>